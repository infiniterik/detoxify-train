default:
  tags:
    - gpu-test

variables:
  DATASET_CONFIG:
    value: "dataset/prochoice.enriched.env"
    options:
      - "dataset/prochoice.enriched.env"
      - "dataset/prolife.enriched.env"

process-raw-data-prochoice:
  image: ihmc-bose/data
  script:
    - source $DATASET_CONFIG
    - wandb artifact get $WANDB_PROJECT/$RAW_DATASET
    - mkdir data
    - python scripts/batch_enrichment.py --use-gpu ./artifacts/$RAW_DATASET/$RAW_DATA $ENRICHED_DATA
    - wandb artifact put --type dataset --name $WANDB_DATASET_NAME $ENRICHED_DATA
